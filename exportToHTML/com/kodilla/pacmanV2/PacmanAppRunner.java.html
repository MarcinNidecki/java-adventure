<html>
<head>
<title>PacmanAppRunner.java</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #cc7832;}
.s1 { color: #a9b7c6;}
.s2 { color: #6897bb;}
.s3 { color: #6a8759;}
</style>
</head>
<body bgcolor="#2b2b2b">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
PacmanAppRunner.java</font>
</center></td></tr></table>
<pre><span class="s0">package </span><span class="s1">com.kodilla.pacmanV2</span><span class="s0">;</span>

import <span class="s1">com.kodilla.pacmanV2.items.Enemy</span><span class="s0">;</span>
import <span class="s1">com.kodilla.pacmanV2.items.ItemPictures</span><span class="s0">;</span>
import <span class="s1">com.kodilla.pacmanV2.items.Player</span><span class="s0">;</span>
import <span class="s1">com.kodilla.pacmanV2.pacmanBoard.Music</span><span class="s0">;</span>
import <span class="s1">com.kodilla.pacmanV2.pacmanBoard.TimerTaskPaccman</span><span class="s0">;</span>
import <span class="s1">com.kodilla.pacmanV2.pacmanBoard.levelFactory.BackgroundImageLevel1</span><span class="s0">;</span>
import <span class="s1">com.kodilla.pacmanV2.pacmanBoard.levelFactory.LevelFactory</span><span class="s0">;</span>
import <span class="s1">com.kodilla.pacmanV2.pacmanBoard.levelFactory.Maze</span><span class="s0">;</span>
import <span class="s1">com.kodilla.pacmanV2.pacmanBoard.statistic.PlayerLives</span><span class="s0">;</span>
import <span class="s1">com.kodilla.pacmanV2.pacmanBoard.statistic.ScoreCounter</span><span class="s0">;</span>

import <span class="s1">javax.swing.*</span><span class="s0">;</span>
import <span class="s1">java.awt.*</span><span class="s0">;</span>
import <span class="s1">java.awt.event.KeyEvent</span><span class="s0">;</span>
import <span class="s1">java.awt.event.KeyListener</span><span class="s0">;</span>
import <span class="s1">java.awt.image.BufferStrategy</span><span class="s0">;</span>

public class <span class="s1">PacmanAppRunner </span><span class="s0">extends </span><span class="s1">Canvas </span><span class="s0">implements </span><span class="s1">Runnable</span><span class="s0">, </span><span class="s1">KeyListener {</span>


    <span class="s0">public static final int </span><span class="s1">WIDTH = </span><span class="s2">1520</span><span class="s0">, </span><span class="s1">HEIGHT = </span><span class="s2">960</span><span class="s0">, </span><span class="s1">TILE_SIZE = </span><span class="s2">40</span><span class="s0">, </span><span class="s1">speed =</span><span class="s2">4</span><span class="s0">;</span>
    private static final <span class="s1">String TITLE = </span><span class="s3">&quot;PACMAN v.0.0.1&quot;</span><span class="s0">;</span>
    private static boolean <span class="s1">isRunning = </span><span class="s0">false;</span>
    public static double <span class="s1">targetTick =</span><span class="s2">45</span><span class="s0">;</span>
    private static   <span class="s1">Player player</span><span class="s0">;</span>
    public static <span class="s1">ScoreCounter score</span><span class="s0">;</span>
    public static boolean <span class="s1">bonus</span><span class="s0">;</span>
    public static <span class="s1">PlayerLives playerLives</span><span class="s0">;</span>
    private static <span class="s1">LevelFactory level = </span><span class="s0">new </span><span class="s1">LevelFactory()</span><span class="s0">;</span>
    private static <span class="s1">Enemy enemyBlue</span><span class="s0">, </span><span class="s1">enemyRed</span><span class="s0">, </span><span class="s1">enemyGreen</span><span class="s0">, </span><span class="s1">enemyPurple</span><span class="s0">;</span>

    private static <span class="s1">BackgroundLevel1 background = </span><span class="s0">new </span><span class="s1">BackgroundLevel1()</span><span class="s0">;</span>
    public <span class="s1">Music music</span><span class="s0">;</span>
    private <span class="s1">TimerTaskPaccman timerMusic</span><span class="s0">, </span><span class="s1">welcomeTimerMusic</span><span class="s0">;</span>
    private <span class="s1">Maze maze</span><span class="s0">;</span>
    private <span class="s1">Thread thread</span><span class="s0">;</span>


    public <span class="s1">PacmanAppRunner() {</span>

        Dimension dimension = <span class="s0">new </span><span class="s1">Dimension(PacmanAppRunner.WIDTH</span><span class="s0">, </span><span class="s1">PacmanAppRunner.HEIGHT)</span><span class="s0">;</span>
        <span class="s1">setPreferredSize(dimension)</span><span class="s0">;</span>
        <span class="s1">setMaximumSize(dimension)</span><span class="s0">;</span>
        <span class="s1">setMinimumSize(dimension)</span><span class="s0">;</span>
        <span class="s1">player = </span><span class="s0">new </span><span class="s1">Player(PacmanAppRunner.TILE_SIZE</span><span class="s0">, </span><span class="s1">PacmanAppRunner.TILE_SIZE * </span><span class="s2">10</span><span class="s1">)</span><span class="s0">;</span>
        <span class="s1">enemyBlue = </span><span class="s0">new </span><span class="s1">Enemy(PacmanAppRunner.TILE_SIZE * </span><span class="s2">19</span><span class="s0">, </span><span class="s1">PacmanAppRunner.TILE_SIZE * </span><span class="s2">10</span><span class="s0">, false,</span><span class="s3">&quot;BLUE&quot;</span><span class="s1">)</span><span class="s0">;</span>
        <span class="s1">enemyRed = </span><span class="s0">new </span><span class="s1">Enemy(PacmanAppRunner.TILE_SIZE * </span><span class="s2">18</span><span class="s0">, </span><span class="s1">PacmanAppRunner.TILE_SIZE * </span><span class="s2">10</span><span class="s0">, true,</span><span class="s3">&quot;RED&quot;</span><span class="s1">)</span><span class="s0">;</span>
        <span class="s1">enemyPurple = </span><span class="s0">new </span><span class="s1">Enemy(PacmanAppRunner.TILE_SIZE*</span><span class="s2">18</span><span class="s0">,</span><span class="s1">PacmanAppRunner.TILE_SIZE*</span><span class="s2">11</span><span class="s0">, true,</span><span class="s3">&quot;PURPLE&quot;</span><span class="s1">)</span><span class="s0">;</span>
        <span class="s1">enemyGreen = </span><span class="s0">new </span><span class="s1">Enemy(PacmanAppRunner.TILE_SIZE*</span><span class="s2">19</span><span class="s0">,</span><span class="s1">PacmanAppRunner.TILE_SIZE*</span><span class="s2">11</span><span class="s0">, false,</span><span class="s3">&quot;GREEN&quot;</span><span class="s1">)</span><span class="s0">;</span>
        <span class="s1">score = </span><span class="s0">new </span><span class="s1">ScoreCounter()</span><span class="s0">;</span>
        <span class="s1">timerMusic = </span><span class="s0">new </span><span class="s1">TimerTaskPaccman(</span><span class="s2">716</span><span class="s1">)</span><span class="s0">;</span>
        <span class="s1">welcomeTimerMusic = </span><span class="s0">new </span><span class="s1">TimerTaskPaccman(</span><span class="s2">4216</span><span class="s1">)</span><span class="s0">;</span>
        <span class="s1">playerLives = </span><span class="s0">new </span><span class="s1">PlayerLives()</span><span class="s0">;</span>
        <span class="s1">music = </span><span class="s0">new </span><span class="s1">Music()</span><span class="s0">;</span>
        <span class="s1">maze = </span><span class="s0">new </span><span class="s1">Maze()</span><span class="s0">;</span>
        <span class="s1">addKeyListener(</span><span class="s0">this</span><span class="s1">)</span><span class="s0">;</span>


    <span class="s1">}</span>

    <span class="s0">public static void </span><span class="s1">main(String[] arg) {</span>


        JFrame frame = <span class="s0">new </span><span class="s1">JFrame()</span><span class="s0">;</span>
        <span class="s1">frame.setBounds(</span><span class="s2">0</span><span class="s0">, </span><span class="s2">0</span><span class="s0">, </span><span class="s2">1600</span><span class="s0">, </span><span class="s2">960</span><span class="s1">)</span><span class="s0">;</span>

        <span class="s1">PacmanAppRunner game = </span><span class="s0">new </span><span class="s1">PacmanAppRunner()</span><span class="s0">;</span>
        <span class="s1">frame.setTitle(PacmanAppRunner.TITLE)</span><span class="s0">;</span>
        <span class="s1">frame.setUndecorated(</span><span class="s0">false</span><span class="s1">)</span><span class="s0">;</span>
        <span class="s1">frame.add(game)</span><span class="s0">;</span>
        <span class="s1">frame.setResizable(</span><span class="s0">false</span><span class="s1">)</span><span class="s0">;</span>
        <span class="s1">frame.pack()</span><span class="s0">;</span>
        <span class="s1">frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE)</span><span class="s0">;</span>
        <span class="s1">frame.setVisible(</span><span class="s0">true</span><span class="s1">)</span><span class="s0">;</span>
        <span class="s1">game.start()</span><span class="s0">;</span>

    <span class="s1">}</span>

    <span class="s0">private synchronized void </span><span class="s1">start() {</span>
        <span class="s0">if </span><span class="s1">(isRunning) </span><span class="s0">return;</span>
        <span class="s1">isRunning = </span><span class="s0">true;</span>
        <span class="s1">thread = </span><span class="s0">new </span><span class="s1">Thread(</span><span class="s0">this</span><span class="s1">)</span><span class="s0">;</span>
        <span class="s1">thread.start()</span><span class="s0">;</span>
    <span class="s1">}</span>

    <span class="s0">private synchronized void </span><span class="s1">stop() {</span>
        <span class="s0">if </span><span class="s1">(!isRunning) </span><span class="s0">return;</span>
        <span class="s1">isRunning = </span><span class="s0">false;</span>
        try <span class="s1">{</span>
            thread.join()<span class="s0">;</span>
        <span class="s1">} </span><span class="s0">catch </span><span class="s1">(InterruptedException e) {</span>
            e.printStackTrace()<span class="s0">;</span>
        <span class="s1">}</span>
    }

    <span class="s0">private void </span><span class="s1">thick() {</span>
        player.tick()<span class="s0">;</span>
        if <span class="s1">(player.isHitByEnemy()) {</span>
            sendEnemyToHome()<span class="s0">;</span>
        <span class="s1">}</span>
        enemyBlue.enemyTick()<span class="s0">;</span>
        <span class="s1">enemyPurple.enemyTick()</span><span class="s0">;</span>
        <span class="s1">enemyGreen.enemyTick()</span><span class="s0">;</span>
        <span class="s1">enemyRed.enemyTick()</span><span class="s0">;</span>
        <span class="s1">maze.tick()</span><span class="s0">;</span>
    <span class="s1">}</span>

    <span class="s0">private void </span><span class="s1">render() {</span>

        BufferStrategy bs = getBufferStrategy()<span class="s0">;</span>
        if <span class="s1">(bs == </span><span class="s0">null</span><span class="s1">) {</span>
            createBufferStrategy(<span class="s2">3</span><span class="s1">)</span><span class="s0">;</span>
            return;
        <span class="s1">}</span>
        Graphics g = bs.getDrawGraphics()<span class="s0">;</span>
        <span class="s1">Graphics2D g2d = (Graphics2D) g</span><span class="s0">;</span>

        <span class="s1">g2d.fillRect(</span><span class="s2">0</span><span class="s0">, </span><span class="s2">0</span><span class="s0">, </span><span class="s1">PacmanAppRunner.WIDTH</span><span class="s0">, </span><span class="s1">PacmanAppRunner.HEIGHT)</span><span class="s0">;</span>
        <span class="s1">ItemPicture itemPicture = </span><span class="s0">new </span><span class="s1">ItemPicture()</span><span class="s0">;</span>
        <span class="s1">background.render(g)</span><span class="s0">;</span>
        <span class="s1">level.render(g)</span><span class="s0">;</span>
        <span class="s1">player.repaint(g)</span><span class="s0">;</span>
        <span class="s1">enemyBlue.paintEnemyBlue(g)</span><span class="s0">;</span>
        <span class="s1">enemyRed.paintEnemyRed(g)</span><span class="s0">;</span>
        <span class="s1">enemyGreen.paintEnemyGreen(g)</span><span class="s0">;</span>
        <span class="s1">enemyPurple.paintEnemyPurple(g)</span><span class="s0">;</span>
        <span class="s1">score.paint(g)</span><span class="s0">;</span>
        <span class="s1">playerLives.paintComponent(g)</span><span class="s0">;</span>

        <span class="s1">g.dispose()</span><span class="s0">;</span>
        <span class="s1">bs.show()</span><span class="s0">;</span>
    <span class="s1">}</span>

    @Override
    <span class="s0">public void </span><span class="s1">run() {</span>
        requestFocus()<span class="s0">;</span>
        int <span class="s1">fps = </span><span class="s2">0</span><span class="s0">;</span>
        double <span class="s1">timer = System.currentTimeMillis()</span><span class="s0">;</span>
        long <span class="s1">lastTime = System.nanoTime()</span><span class="s0">;</span>

        double <span class="s1">delta = </span><span class="s2">0</span><span class="s0">;</span>
        double <span class="s1">ns = </span><span class="s2">1000000000 </span><span class="s1">/ targetTick</span><span class="s0">;</span>

        <span class="s1">music.playWelocmeSound()</span><span class="s0">;</span>
        <span class="s1">welcomeTimerMusic.StartTimer()</span><span class="s0">;</span>


        while <span class="s1">(isRunning) {</span>


            <span class="s0">long </span><span class="s1">now = System.nanoTime()</span><span class="s0">;</span>
            <span class="s1">delta += (now - lastTime) / ns</span><span class="s0">;</span>
            <span class="s1">lastTime = now</span><span class="s0">;</span>

            while <span class="s1">(delta &gt;= </span><span class="s2">1</span><span class="s1">) {</span>

                welcomeTimerMusic.checkIfTimerIsEnd()<span class="s0">;</span>
                if <span class="s1">(welcomeTimerMusic.isTimerON()) {</span>
                    <span class="s0">if </span><span class="s1">(timerMusic.isTimerON()) {</span>
                        timerMusic.StartTimer()<span class="s0">;</span>
                        <span class="s1">music.playBackgroundSound()</span><span class="s0">;</span>
                    <span class="s1">}</span>
                    timerMusic.checkIfTimerIsEnd()<span class="s0">;</span>
                <span class="s1">}</span>


                render()<span class="s0">;</span>
                <span class="s1">thick()</span><span class="s0">;</span>

                <span class="s1">fps++</span><span class="s0">;</span>
                <span class="s1">delta--</span><span class="s0">;</span>
            <span class="s1">}</span>
            <span class="s0">if </span><span class="s1">(System.currentTimeMillis() - timer &gt;= </span><span class="s2">1000</span><span class="s1">) {</span>
                System.out.println(fps)<span class="s0">;</span>
                <span class="s1">fps = </span><span class="s2">0</span><span class="s0">;</span>
                <span class="s1">timer += </span><span class="s2">1000</span><span class="s0">;</span>
            <span class="s1">}</span>
        }
        stop()<span class="s0">;</span>
    <span class="s1">}</span>

    @Override
    <span class="s0">public void </span><span class="s1">keyTyped(KeyEvent e) {</span>
    }

    @Override
    <span class="s0">public void </span><span class="s1">keyPressed(KeyEvent e) {</span>
        <span class="s0">if </span><span class="s1">(e.getKeyCode() == KeyEvent.VK_RIGHT) {</span>

           <span class="s0">if </span><span class="s1">(player.getMainDirection().equals(</span><span class="s3">&quot;LEFT&quot;</span><span class="s1">) || player.getMainDirection().equals(</span><span class="s3">&quot;STOP&quot;</span><span class="s1">)) {</span>
               player.setMainDirection(<span class="s3">&quot;RIGHT&quot;</span><span class="s1">)</span><span class="s0">;</span>
               <span class="s1">player.setNextDirection(</span><span class="s3">&quot;STOP&quot;</span><span class="s1">)</span><span class="s0">;</span>

           <span class="s1">} </span><span class="s0">else if </span><span class="s1">(player.getMainDirection().equals(</span><span class="s3">&quot;UP&quot;</span><span class="s1">) || player.getMainDirection().equals(</span><span class="s3">&quot;DOWN&quot;</span><span class="s1">)) {</span>
               player.setNextDirection(<span class="s3">&quot;RIGHT&quot;</span><span class="s1">)</span><span class="s0">;</span>

           <span class="s1">}</span>

        }
        <span class="s0">if </span><span class="s1">(e.getKeyCode() == KeyEvent.VK_LEFT) {</span>
            <span class="s0">if </span><span class="s1">(player.getMainDirection().equals(</span><span class="s3">&quot;RIGHT&quot;</span><span class="s1">) || player.getMainDirection().equals(</span><span class="s3">&quot;STOP&quot;</span><span class="s1">)) {</span>
                player.setMainDirection(<span class="s3">&quot;LEFT&quot;</span><span class="s1">)</span><span class="s0">;</span>
                <span class="s1">player.setNextDirection(</span><span class="s3">&quot;STOP&quot;</span><span class="s1">)</span><span class="s0">;</span>
            <span class="s1">} </span><span class="s0">else if </span><span class="s1">(player.getMainDirection().equals(</span><span class="s3">&quot;UP&quot;</span><span class="s1">) || player.getMainDirection().equals(</span><span class="s3">&quot;DOWN&quot;</span><span class="s1">)) {</span>
                player.setNextDirection(<span class="s3">&quot;LEFT&quot;</span><span class="s1">)</span><span class="s0">;</span>

            <span class="s1">}</span>
        }
        <span class="s0">if </span><span class="s1">(e.getKeyCode() == KeyEvent.VK_DOWN) {</span>
            <span class="s0">if </span><span class="s1">(player.getMainDirection().equals(</span><span class="s3">&quot;UP&quot;</span><span class="s1">)  || player.getMainDirection().equals(</span><span class="s3">&quot;STOP&quot;</span><span class="s1">)) {</span>
                player.setMainDirection(<span class="s3">&quot;DOWN&quot;</span><span class="s1">)</span><span class="s0">;</span>
                <span class="s1">player.setNextDirection(</span><span class="s3">&quot;STOP&quot;</span><span class="s1">)</span><span class="s0">;</span>

            <span class="s1">} </span><span class="s0">else if </span><span class="s1">(player.getMainDirection().equals(</span><span class="s3">&quot;LEFT&quot;</span><span class="s1">) || player.getMainDirection().equals(</span><span class="s3">&quot;RIGHT&quot;</span><span class="s1">)) {</span>

                player.setNextDirection(<span class="s3">&quot;DOWN&quot;</span><span class="s1">)</span><span class="s0">;</span>
            <span class="s1">}</span>
        }
        <span class="s0">if </span><span class="s1">(e.getKeyCode() == KeyEvent.VK_UP)  {</span>
            <span class="s0">if </span><span class="s1">(player.getMainDirection().equals(</span><span class="s3">&quot;DOWN&quot;</span><span class="s1">) || player.getMainDirection().equals(</span><span class="s3">&quot;STOP&quot;</span><span class="s1">)) {</span>
                player.setMainDirection(<span class="s3">&quot;UP&quot;</span><span class="s1">)</span><span class="s0">;</span>
                <span class="s1">player.setNextDirection(</span><span class="s3">&quot;STOP&quot;</span><span class="s1">)</span><span class="s0">;</span>
            <span class="s1">} </span><span class="s0">else if </span><span class="s1">(player.getMainDirection().equals(</span><span class="s3">&quot;LEFT&quot;</span><span class="s1">) || player.getMainDirection().equals(</span><span class="s3">&quot;RIGHT&quot;</span><span class="s1">)) {</span>
                player.setNextDirection(<span class="s3">&quot;UP&quot;</span><span class="s1">)</span><span class="s0">;</span>
            <span class="s1">}</span>
        }
    }

    @Override
    <span class="s0">public void </span><span class="s1">keyReleased(KeyEvent e) {</span>

    }


    <span class="s0">public static </span><span class="s1">Player getPlayer() {</span>
        <span class="s0">return </span><span class="s1">player</span><span class="s0">;</span>
    <span class="s1">}</span>

    <span class="s0">private void </span><span class="s1">sendEnemyToHome() {</span>

            enemyRed.setLocation(enemyRed.getStartingLocationX()<span class="s0">,</span><span class="s1">enemyRed.getStartingLocationY())</span><span class="s0">;</span>
            <span class="s1">enemyBlue.setLocation(enemyBlue.getStartingLocationX()</span><span class="s0">, </span><span class="s1">enemyBlue.getStartingLocationY())</span><span class="s0">;</span>
            <span class="s1">enemyPurple.setLocation(enemyPurple.getStartingLocationX()</span><span class="s0">,</span><span class="s1">enemyPurple.getStartingLocationY())</span><span class="s0">;</span>
            <span class="s1">enemyGreen.setLocation(enemyGreen.getStartingLocationX()</span><span class="s0">,</span><span class="s1">enemyGreen.getStartingLocationY())</span><span class="s0">;</span>
            <span class="s1">enemyRed.waitThenGoOutside(</span><span class="s2">5</span><span class="s1">)</span><span class="s0">;</span>
            <span class="s1">enemyBlue.waitThenGoOutside(</span><span class="s2">5</span><span class="s1">)</span><span class="s0">;</span>
            <span class="s1">enemyGreen.waitThenGoOutside(</span><span class="s2">5</span><span class="s1">)</span><span class="s0">;</span>
            <span class="s1">enemyPurple.waitThenGoOutside(</span><span class="s2">5</span><span class="s1">)</span><span class="s0">;</span>
            <span class="s1">player.setHitByEnemy(</span><span class="s0">false</span><span class="s1">)</span><span class="s0">;</span>
            <span class="s1">player.setLocation(</span><span class="s2">40</span><span class="s0">,</span><span class="s2">40</span><span class="s1">)</span><span class="s0">;</span>

    <span class="s1">}</span>
}
</pre>
</body>
</html>